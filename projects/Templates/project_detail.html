{% extends "dashboard/Templates/base.html" %}
{% load i18n %}

{% block page_content %}

<style>
    .programming-lang {
        color: #27639d;
        font-weight: bold;
        margin-right: 5px;
    }
    .task-details {
        margin-top: 10px;
        padding: 10px;
        background-color: #f8f9fa;
        border-radius: 5px;
    }
    .owner-only {
        background-color: #e9ecef;
        padding: 10px;
        border-radius: 5px;
        margin-top: 10px;
    }
    .applications {
        margin-top: 10px;
        padding: 10px;
        background-color: #f1f3f5;
        border-radius: 5px;
    }
</style>

<div class="container mt-4">
    <!-- TÃ­tulo do Projeto Estilizado -->
    <div class="row">
        <div class="col-12">
            <h1>
                {% trans "Projeto:" %}
                <span style="color: #27639d; font-weight: bold; font-size: 1.5em;">{{ project.title }}</span>
            </h1>
        </div>
    </div>
    
    <!-- Colunas para Dados do Projeto e Tasks -->
    <div class="row">
        <!-- Coluna com os Dados do Projeto -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <p><strong>{% trans "Category:" %}</strong> {{ project.category }}</p>
                    <p><strong>{% trans "Description:" %}</strong> {{ project.description }}</p>
                    <p><strong>{% trans "Created by:" %}</strong> {{ project.created_by }}</p>
                    <p><strong>{% trans "Date Created:" %}</strong> {{ project.date_created|date:"Y-m-d H:i" }}</p>
                    <p><strong>{% trans "Last Updated:" %}</strong> {{ project.date_updated|date:"Y-m-d H:i" }}</p>
                    <p><strong>{% trans "Unique Programming Languages:" %}</strong>
                        {% for language in project.get_unique_languages %}
                            <span class="programming-lang">{{ language.name }}</span>
                        {% empty %}
                            {% trans "No languages specified" %}
                        {% endfor %}
                    </p>
                </div>
            </div>
        </div>

        <!-- Coluna com as Tasks -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h2>{% trans "Tasks" %}</h2>
                    <div class="list-group">
                        {% for task in project.tasks.all %}
                        <div class="list-group-item">
                            <h4>{{ task.title }}</h4>
                            <p>{{ task.description }}</p>
                            <div class="task-details">
                                <p><strong>{% trans "Status:" %}</strong> {{ task.get_status_display }}</p>
                                <p><strong>{% trans "Due Date:" %}</strong> {{ task.due_date|date:"Y-m-d" }}</p>
                                <p><strong>{% trans "Initial Value:" %}</strong> {{ task.initial_value }}</p>
                                <p><strong>{% trans "Application Status:" %}</strong> {{ task.get_application_status_display }}</p>
                                <p><strong>{% trans "Programming Languages:" %}</strong>
                                    {% for language in task.programming_languages.all %}
                                        <span class="programming-lang">{{ language.name }}</span>
                                    {% empty %}
                                        {% trans "No languages specified" %}
                                    {% endfor %}
                                </p>
                            </div>
                            
                            {% if is_project_owner %}
                            <div class="owner-only">
                                <p><strong>{% trans "Assigned to:" %}</strong> {{ task.assigned_to|default_if_none:"Not assigned" }}</p>
                                
                                <div class="applications">
                                    <h5>{% trans "Applications" %}</h5>
                                    {% for application in task.applications.all %}
                                    <div class="application">
                                        <p><strong>{% trans "Developer:" %}</strong> {{ application.developer.username }}</p>
                                        <p><strong>{% trans "Proposed Value:" %}</strong> {{ application.proposed_value }}</p>
                                        <p><strong>{% trans "Application Date:" %}</strong> {{ application.application_date|date:"Y-m-d H:i" }}</p>
                                        <p><strong>{% trans "Status:" %}</strong> {{ application.get_status_display }}</p>
                                    </div>
                                    {% if not forloop.last %}<hr>{% endif %}
                                    {% empty %}
                                    <p>{% trans "No applications yet." %}</p>
                                    {% endfor %}
                                </div>
                            </div>
                            {% endif %}
                        </div>
                        {% empty %}
                        <p>{% trans "No tasks available." %}</p>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}